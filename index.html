<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnimeCosplay India - Premium Anime Costumes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // React Components
        const { useState, useEffect, useRef } = React;

        // User Authentication System
        const AuthService = {
            // In a real app, this would be API calls to a backend
            users: JSON.parse(localStorage.getItem('animeCosplayUsers')) || [],
            currentUser: JSON.parse(localStorage.getItem('animeCosplayCurrentUser')) || null,
            
            signup: function(userData) {
                // Check if user already exists
                const existingUser = this.users.find(user => user.email === userData.email);
                if (existingUser) {
                    return { success: false, message: 'User with this email already exists' };
                }
                
                // Create new user
                const newUser = {
                    id: Date.now().toString(),
                    ...userData,
                    createdAt: new Date().toISOString(),
                    orders: []
                };
                
                this.users.push(newUser);
                localStorage.setItem('animeCosplayUsers', JSON.stringify(this.users));
                
                return { success: true, user: newUser };
            },
            
            login: function(email, password) {
                const user = this.users.find(u => u.email === email && u.password === password);
                if (user) {
                    this.currentUser = user;
                    localStorage.setItem('animeCosplayCurrentUser', JSON.stringify(user));
                    return { success: true, user };
                } else {
                    return { success: false, message: 'Invalid email or password' };
                }
            },
            
            logout: function() {
                this.currentUser = null;
                localStorage.removeItem('animeCosplayCurrentUser');
            },
            
            updateProfile: function(userId, updates) {
                const userIndex = this.users.findIndex(u => u.id === userId);
                if (userIndex !== -1) {
                    this.users[userIndex] = { ...this.users[userIndex], ...updates };
                    localStorage.setItem('animeCosplayUsers', JSON.stringify(this.users));
                    
                    if (this.currentUser && this.currentUser.id === userId) {
                        this.currentUser = this.users[userIndex];
                        localStorage.setItem('animeCosplayCurrentUser', JSON.stringify(this.currentUser));
                    }
                    
                    return { success: true, user: this.users[userIndex] };
                }
                return { success: false, message: 'User not found' };
            },
            
            addOrder: function(userId, order) {
                const userIndex = this.users.findIndex(u => u.id === userId);
                if (userIndex !== -1) {
                    const newOrder = {
                        id: `ORD${Date.now()}`,
                        ...order,
                        date: new Date().toISOString(),
                        status: 'pending'
                    };
                    
                    this.users[userIndex].orders.unshift(newOrder);
                    localStorage.setItem('animeCosplayUsers', JSON.stringify(this.users));
                    
                    if (this.currentUser && this.currentUser.id === userId) {
                        this.currentUser.orders.unshift(newOrder);
                        localStorage.setItem('animeCosplayCurrentUser', JSON.stringify(this.currentUser));
                    }
                    
                    return { success: true, order: newOrder };
                }
                return { success: false, message: 'User not found' };
            }
        };

        // Extensive Product Database with ALL requested anime
        const productDatabase = {
            "one-piece": {
                title: "One Piece Costumes",
                description: "Dress up as your favorite pirates from the Grand Line!",
                products: [
                   { id: 1, name: "Monkey D. Luffy Costume", price: 2499, rating: 4.5, reviews: 128, image: "https://hokagestore.com/wp-content/uploads/2018/09/33012-4a63aa.jpeg", badge: "Best Seller", description: "Complete Luffy costume with straw hat, red vest, and blue shorts. Perfect for any pirate adventure!", category: "one-piece", sizes: ["S", "M", "L", "XL"], inStock: true, featured: true },
                    { id: 2, name: "Roronoa Zoro Costume", price: 2699, rating: 4.7, reviews: 95, image: "https://th.bing.com/th/id/R.78bceb43b38b60861974fc031bf6ea2c?rik=8PZPKmssIDHz%2fw&riu=http%3a%2f%2fnalagila.com%2fwp-content%2fuploads%2f2023%2f10%2fone-piece-roronoa-zoro-cosplay-costume-animego-store-1_843c36f1-19c3-48db-85dd-8a3326cd5adc.jpg&ehk=f%2bQCcdQ04ZyRCpwxd9wbVIyRQFn0Cb66ggHyd4AKL7Y%3d&risl=&pid=ImgRaw&r=0", badge: "New", description: "Zoro's iconic green haramaki and swordsman outfit with three swords. Become the world's greatest swordsman!", category: "one-piece", sizes: ["M", "L", "XL"], inStock: true, featured: true },
                    { id: 3, name: "Sanji Vinsmoke Costume", price: 2599, rating: 4.4, reviews: 87, image: "https://down-ph.img.susercontent.com/file/sg-11134201-7rd6g-lwtynr7gwbwe6a", description: "Sanji's black suit with tie and blonde wig. Cook up some trouble in style!", category: "one-piece", sizes: ["S", "M", "L", "XL"], inStock: true, featured: false },
                    { id: 4, name: "Nami Costume", price: 2399, rating: 4.6, reviews: 112, image: "https://images.unsplash.com/photo-1635805737707-575885ab0820?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Nami's orange bikini top and shorts with weather staff. Navigate your way to the best costume!", category: "one-piece", sizes: ["XS", "S", "M"], inStock: true, featured: false },
                    { id: 5, name: "Tony Tony Chopper Costume", price: 2999, rating: 4.8, reviews: 76, image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", badge: "Hot", description: "Full-body Chopper costume with pink hat and blue nose. The cutest crew member!", category: "one-piece", sizes: ["One Size"], inStock: true, featured: true },
                    { id: 6, name: "Nico Robin Costume", price: 2799, rating: 4.5, reviews: 68, image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Robin's cowboy hat and floral dress outfit. Uncover history in style!", category: "one-piece", sizes: ["S", "M", "L"], inStock: true, featured: false },
                    { id: 7, name: "Franky Costume", price: 3499, rating: 4.3, reviews: 54, image: "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Franky's super robot-style outfit with blue hair and sunglasses. SUPER costume!", category: "one-piece", sizes: ["L", "XL", "XXL"], inStock: true, featured: false },
                    { id: 8, name: "Brook Costume", price: 2899, rating: 4.7, reviews: 42, image: "https://images.unsplash.com/photo-1635805737707-575885ab0820?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Brook's gentleman skeleton outfit with afro and cane sword. Yohohoho!", category: "one-piece", sizes: ["M", "L", "XL"], inStock: true, featured: false },
                    { id: 9, name: "Jinbe Costume", price: 3199, rating: 4.4, reviews: 38, image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Jinbe's traditional Japanese clothing with whale shark pattern. The honorable knight of the sea!", category: "one-piece", sizes: ["L", "XL", "XXL"], inStock: true, featured: false },
                    { id: 10, name: "Trafalgar Law Costume", price: 2699, rating: 4.6, reviews: 91, image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Law's spotted hat and hoodie with sword. Create your own room!", category: "one-piece", sizes: ["M", "L", "XL"], inStock: true, featured: true }
                ]
            },
            "naruto": {
                title: "Naruto Costumes",
                description: "Become a ninja from the Hidden Leaf Village!",
                products: [
                    { id: 11, name: "Naruto Uzumaki Costume", price: 2199, rating: 4.5, reviews: 95, image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", badge: "New", description: "Naruto's orange jumpsuit with Konoha headband and blonde wig. Believe it!", category: "naruto", sizes: ["S", "M", "L", "XL"], inStock: true, featured: true },
                    { id: 12, name: "Sasuke Uchiha Costume", price: 2399, rating: 4.7, reviews: 87, image: "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Sasuke's blue shirt and white shorts with Uchiha crest. Avenger style!", category: "naruto", sizes: ["S", "M", "L"], inStock: true, featured: true },
                    { id: 13, name: "Sakura Haruno Costume", price: 2099, rating: 4.3, reviews: 73, image: "https://images.unsplash.com/photo-1635805737707-575885ab0820?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Sakura's red dress with pink hair and forehead protector. Medical ninja ready!", category: "naruto", sizes: ["XS", "S", "M"], inStock: true, featured: false },
                    { id: 14, name: "Kakashi Hatake Costume", price: 2599, rating: 4.8, reviews: 112, image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", badge: "Best Seller", description: "Kakashi's jonin uniform with mask and sharingan eye. Copy ninja style!", category: "naruto", sizes: ["M", "L", "XL"], inStock: true, featured: true },
                    { id: 15, name: "Itachi Uchiha Costume", price: 2499, rating: 4.6, reviews: 68, image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Itachi's Akatsuki cloak with red clouds and sharingan contacts. For my little brother...", category: "naruto", sizes: ["M", "L", "XL"], inStock: true, featured: false },
                    { id: 16, name: "Hinata Hyuga Costume", price: 2299, rating: 4.4, reviews: 59, image: "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Hinata's purple jacket and shorts with byakugan contacts. Gentle fist style!", category: "naruto", sizes: ["XS", "S", "M"], inStock: true, featured: false },
                    { id: 17, name: "Gaara Costume", price: 2399, rating: 4.5, reviews: 47, image: "https://images.unsplash.com/photo-1635805737707-575885ab0820?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Gaara's gourd and red hair with Kazekage outfit. Sand manipulation ready!", category: "naruto", sizes: ["M", "L", "XL"], inStock: true, featured: false },
                    { id: 18, name: "Rock Lee Costume", price: 2199, rating: 4.2, reviews: 41, image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Rock Lee's green jumpsuit with bowl haircut and eyebrows. Power of youth!", category: "naruto", sizes: ["S", "M", "L"], inStock: true, featured: false },
                    { id: 19, name: "Jiraiya Costume", price: 2799, rating: 4.7, reviews: 63, image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Jiraiya's red vest and geta sandals with white hair. Toad sage style!", category: "naruto", sizes: ["L", "XL", "XXL"], inStock: true, featured: false },
                    { id: 20, name: "Tsunade Costume", price: 2699, rating: 4.5, reviews: 52, image: "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Tsunade's green haori and diamond forehead seal. The Fifth Hokage!", category: "naruto", sizes: ["S", "M", "L"], inStock: true, featured: false }
                ]
            },
            "attack-on-titan": {
                title: "Attack on Titan Costumes",
                description: "Join the Survey Corps and fight against the Titans!",
                products: [
                    { id: 21, name: "Levi Ackerman Uniform", price: 2899, rating: 4.8, reviews: 142, image: "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", badge: "Best Seller", description: "Levi's Survey Corps uniform with ODM gear and cape. Humanity's strongest soldier!", category: "attack-on-titan", sizes: ["S", "M", "L"], inStock: true, featured: true },
                    { id: 22, name: "Eren Yeager Costume", price: 2699, rating: 4.6, reviews: 118, image: "https://images.unsplash.com/photo-1635805737707-575885ab0820?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Eren's Survey Corps uniform with brown wig and determined expression. Fight for freedom!", category: "attack-on-titan", sizes: ["M", "L", "XL"], inStock: true, featured: true },
                    { id: 23, name: "Mikasa Ackerman Costume", price: 2599, rating: 4.7, reviews: 96, image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Mikasa's red scarf and Survey Corps uniform with black hair. Protect what matters!", category: "attack-on-titan", sizes: ["XS", "S", "M"], inStock: true, featured: true },
                    { id: 24, name: "Armin Arlert Costume", price: 2499, rating: 4.4, reviews: 74, image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Armin's Survey Corps uniform with blonde hair and strategic mind. The brains of the operation!", category: "attack-on-titan", sizes: ["S", "M", "L"], inStock: true, featured: false },
                    { id: 25, name: "Hange Zoe Costume", price: 2799, rating: 4.5, reviews: 58, image: "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Hange's glasses and Survey Corps uniform with titan research gear. For science!", category: "attack-on-titan", sizes: ["M", "L"], inStock: true, featured: false },
                    { id: 26, name: "Erwin Smith Costume", price: 2999, rating: 4.7, reviews: 62, image: "https://images.unsplash.com/photo-1635805737707-575885ab0820?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Erwin's commander uniform with blonde hair and leadership presence. SHINZOU WO SASAGEYO!", category: "attack-on-titan", sizes: ["L", "XL"], inStock: true, featured: false },
                    { id: 27, name: "Annie Leonhart Costume", price: 2599, rating: 4.3, reviews: 49, image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Annie's Military Police Brigade uniform with blonde hair. The Female Titan!", category: "attack-on-titan", sizes: ["XS", "S", "M"], inStock: true, featured: false },
                    { id: 28, name: "Reiner Braun Costume", price: 2699, rating: 4.4, reviews: 53, image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Reiner's armored titan inspired uniform with blonde hair. The Armored Titan!", category: "attack-on-titan", sizes: ["L", "XL", "XXL"], inStock: true, featured: false },
                    { id: 29, name: "Bertolt Hoover Costume", price: 2499, rating: 4.2, reviews: 41, image: "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Bertolt's colossal titan inspired uniform with black hair. The Colossal Titan!", category: "attack-on-titan", sizes: ["M", "L", "XL"], inStock: true, featured: false },
                    { id: 30, name: "Sasha Blouse Costume", price: 2399, rating: 4.6, reviews: 67, image: "https://images.unsplash.com/photo-1635805737707-575885ab0820?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80", description: "Sasha's Survey Corps uniform with brown ponytail and potato. The potato girl!", category: "attack-on-titan", sizes: ["S", "M"], inStock: true, featured: false }
                ]
            }
        };

        // Toast Component
        const Toast = ({ message, type, show, onClose }) => {
            useEffect(() => {
                if (show) {
                    const timer = setTimeout(() => {
                        onClose();
                    }, 4000);
                    return () => clearTimeout(timer);
                }
            }, [show, onClose]);

            if (!show) return null;

            const icons = {
                '': 'fas fa-check-circle',
                'success': 'fas fa-check-circle',
                'error': 'fas fa-exclamation-circle',
                'warning': 'fas fa-exclamation-triangle',
                'info': 'fas fa-info-circle'
            };

            return ReactDOM.createPortal(
                <div className={`toast ${type} ${show ? 'show' : ''}`}>
                    <i className={icons[type]}></i>
                    <div className="toast-content">
                        <div className="toast-title">
                            {type === 'success' && 'Success!'}
                            {type === 'error' && 'Error!'}
                            {type === 'warning' && 'Warning!'}
                            {type === 'info' && 'Information'}
                            {!type && 'Notification'}
                        </div>
                        <div className="toast-message">{message}</div>
                    </div>
                    <div className="close-toast" onClick={onClose}>
                        <i className="fas fa-times"></i>
                    </div>
                </div>,
                document.body
            );
        };

        // Header Component
        const Header = ({ onLoginClick, onCartClick, onWishlistClick, cartCount, wishlistCount, activeCategory, onCategoryChange, onSearch, onSearchResultClick, currentUser, onLogout, onAccountClick }) => {
            const categories = [
                "One Piece", "Naruto", "Attack on Titan", "My Hero Academia", 
                "One Punch Man", "Demon Slayer", "Black Clover", "Dragon Ball", 
                "Jujutsu Kaisen", "Solo Leveling", "Accessories"
            ];

            const handleCategoryClick = (category) => {
                onCategoryChange(category);
            };

            return (
                <header>
                    <div className="container">
                        <div className="header-top">
                            <div className="logo">
                                <i className="fas fa-mask"></i>
                                <span>AnimeCosplay India</span>
                            </div>
                            <SearchBar onSearch={onSearch} onSearchResultClick={onSearchResultClick} />
                            <div className="header-actions">
                                {currentUser ? (
                                    <div className="user-profile">
                                        <div className="user-avatar">
                                            {currentUser.name.charAt(0).toUpperCase()}
                                        </div>
                                        <div className="header-action" onClick={onAccountClick}>
                                            <i className="fas fa-user"></i>
                                            <span>{currentUser.name.split(' ')[0]}</span>
                                        </div>
                                        <div className="header-action" onClick={onLogout}>
                                            <i className="fas fa-sign-out-alt"></i>
                                            <span>Logout</span>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="header-action" onClick={onLoginClick}>
                                        <i className="fas fa-user"></i>
                                        <span>Login</span>
                                    </div>
                                )}
                                <div className="header-action wishlist-icon" onClick={onWishlistClick}>
                                    <i className="fas fa-heart"></i>
                                    <span>Wishlist</span>
                                    <div className="wishlist-count">{wishlistCount}</div>
                                </div>
                                <div className="header-action cart-icon" onClick={onCartClick}>
                                    <i className="fas fa-shopping-cart"></i>
                                    <span>Cart</span>
                                    <div className="cart-count">{cartCount}</div>
                                </div>
                            </div>
                        </div>
                        <nav>
                            <ul className="nav-links">
                                <li><a href="#" className={!activeCategory ? 'active' : ''} onClick={() => handleCategoryClick('')}>Home</a></li>
                                {categories.map(category => (
                                    <li key={category}>
                                        <a 
                                            href="#" 
                                            className={activeCategory === category.toLowerCase().replace(/ /g, '-') ? 'active' : ''}
                                            onClick={() => handleCategoryClick(category.toLowerCase().replace(/ /g, '-'))}
                                        >
                                            {category}
                                        </a>
                                    </li>
                                ))}
                            </ul>
                        </nav>
                    </div>
                </header>
            );
        };

        // Search Component
        const SearchBar = ({ onSearch, onSearchResultClick }) => {
            const [searchQuery, setSearchQuery] = useState('');
            const [searchResults, setSearchResults] = useState([]);
            const [showResults, setShowResults] = useState(false);
            const searchRef = useRef(null);

            useEffect(() => {
                const handleClickOutside = (event) => {
                    if (searchRef.current && !searchRef.current.contains(event.target)) {
                        setShowResults(false);
                    }
                };

                document.addEventListener('mousedown', handleClickOutside);
                return () => {
                    document.removeEventListener('mousedown', handleClickOutside);
                };
            }, []);

            const handleSearch = (query) => {
                setSearchQuery(query);
                
                if (query.trim() === '') {
                    setSearchResults([]);
                    setShowResults(false);
                    return;
                }

                const results = [];
                const lowerCaseQuery = query.toLowerCase();

                // Search through all anime and products
                Object.keys(productDatabase).forEach(animeKey => {
                    const anime = productDatabase[animeKey];
                    
                    // Check if anime title matches
                    if (anime.title.toLowerCase().includes(lowerCaseQuery)) {
                        results.push({
                            type: 'anime',
                            title: anime.title,
                            description: anime.description,
                            key: animeKey
                        });
                    }
                    
                    // Check if any product matches
                    anime.products.forEach(product => {
                        if (product.name.toLowerCase().includes(lowerCaseQuery)) {
                            results.push({
                                type: 'product',
                                ...product,
                                animeTitle: anime.title,
                                animeKey: animeKey
                            });
                        }
                    });
                });

                setSearchResults(results);
                setShowResults(results.length > 0);
            };

            const handleResultClick = (result) => {
                if (result.type === 'anime') {
                    onSearchResultClick(result.key);
                } else {
                    onSearchResultClick(result.animeKey, result);
                }
                setShowResults(false);
                setSearchQuery('');
            };

            const handleViewAllResults = () => {
                onSearch(searchQuery);
                setShowResults(false);
            };

            return (
                <div className="search-bar" ref={searchRef}>
                    <input 
                        type="text" 
                        placeholder="Search for costumes, accessories..." 
                        value={searchQuery}
                        onChange={(e) => handleSearch(e.target.value)}
                        onFocus={() => searchQuery && setShowResults(true)}
                    />
                    <button onClick={() => onSearch(searchQuery)}><i className="fas fa-search"></i></button>
                    
                    {showResults && (
                        <div className="search-results active">
                            {searchResults.slice(0, 5).map((result, index) => (
                                <div 
                                    key={index} 
                                    className="search-result-item"
                                    onClick={() => handleResultClick(result)}
                                >
                                    {result.type === 'product' && (
                                        <div 
                                            className="search-result-img" 
                                            style={{ backgroundImage: `url(${result.image})` }}
                                        ></div>
                                    )}
                                    <div className="search-result-info">
                                        <div className="search-result-name">
                                            {result.type === 'anime' ? result.title : result.name}
                                        </div>
                                        {result.type === 'product' && (
                                            <div className="search-result-price">₹{result.price.toLocaleString()}</div>
                                        )}
                                        <div className="search-result-category">
                                            {result.type === 'anime' ? 'Anime Category' : result.animeTitle}
                                        </div>
                                    </div>
                                </div>
                            ))}
                            {searchResults.length > 5 && (
                                <div 
                                    className="search-result-item text-center" 
                                    style={{ justifyContent: 'center', fontWeight: '600', color: 'var(--primary)' }}
                                    onClick={handleViewAllResults}
                                >
                                    View all {searchResults.length} results
                                </div>
                            )}
                            {searchResults.length === 0 && (
                                <div className="no-results">No results found for "{searchQuery}"</div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        // Hero Component
        const Hero = () => {
            return (
                <section className="hero">
                    <div className="container">
                        <div className="hero-content">
                            <h1>Premium Anime Cosplay Costumes</h1>
                            <p>Discover the largest collection of authentic anime cosplay costumes in India. From Naruto to Demon Slayer, we have everything you need for your next convention or event.</p>
                            <a href="#" className="cta-button">Shop Now <i className="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                </section>
            );
        };

        // Categories Component
        const Categories = ({ onCategoryClick }) => {
            const categories = [
                { name: "One Piece", image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" },
                { name: "Naruto", image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" },
                { name: "Attack on Titan", image: "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" },
                { name: "My Hero Academia", image: "https://images.unsplash.com/photo-1635805737707-575885ab0820?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" },
                { name: "One Punch Man", image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" },
                { name: "Demon Slayer", image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" },
                { name: "Black Clover", image: "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" },
                { name: "Dragon Ball", image: "https://images.unsplash.com/photo-1635805737707-575885ab0820?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" },
                { name: "Jujutsu Kaisen", image: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" },
                { name: "Solo Leveling", image: "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" }
            ];

            return (
                <section className="container">
                    <h2 className="section-title">Shop By Anime</h2>
                    <div className="categories">
                        {categories.map((category, index) => (
                            <div key={index} className="category-card" onClick={() => onCategoryClick(category.name.toLowerCase().replace(/ /g, '-'))}>
                                <div className="category-img" style={{ backgroundImage: `url(${category.image})` }}></div>
                                <div className="category-name">{category.name}</div>
                                <div className="category-overlay">
                                    <span>View {category.name} Costumes</span>
                                </div>
                            </div>
                        ))}
                    </div>
                </section>
            );
        };

        // Product Card Component
        const ProductCard = ({ product, onProductClick, onAddToCart, onWishlist, isWishlisted, onViewDetails }) => {
            const renderStars = (rating) => {
                const stars = [];
                const fullStars = Math.floor(rating);
                const hasHalfStar = rating % 1 !== 0;

                for (let i = 0; i < fullStars; i++) {
                    stars.push(<i key={i} className="fas fa-star"></i>);
                }

                if (hasHalfStar) {
                    stars.push(<i key="half" className="fas fa-star-half-alt"></i>);
                }

                const emptyStars = 5 - stars.length;
                for (let i = 0; i < emptyStars; i++) {
                    stars.push(<i key={`empty-${i}`} className="far fa-star"></i>);
                }

                return stars;
            };

            return (
                <div className="product-card fade-in">
                    <div className="product-img" style={{ backgroundImage: `url(${product.image})` }}>
                        {product.badge && <div className={`product-badge ${product.badge.toLowerCase().replace(/ /g, '-')}`}>{product.badge}</div>}
                    </div>
                    <div className="product-info">
                        <div className="product-title">{product.name}</div>
                        <div className="product-price">₹{product.price.toLocaleString()}</div>
                        <div className="product-rating">
                            {renderStars(product.rating)}
                            <span>({product.reviews})</span>
                        </div>
                        <div className="product-actions">
                            <button className="add-to-cart" onClick={(e) => { e.stopPropagation(); onAddToCart(product); }}>
                                <i className="fas fa-shopping-cart"></i> Add to Cart
                            </button>
                            <button 
                                className={`wishlist ${isWishlisted ? 'active' : ''}`} 
                                onClick={(e) => { e.stopPropagation(); onWishlist(product, !isWishlisted); }}
                            >
                                <i className={isWishlisted ? "fas fa-heart" : "far fa-heart"}></i>
                            </button>
                        </div>
                        <button className="view-details" onClick={(e) => { e.stopPropagation(); onViewDetails(product); }}>
                            <i className="fas fa-eye"></i> View Details
                        </button>
                    </div>
                </div>
            );
        };

        // Products Section Component
        const ProductsSection = ({ title, products, onProductClick, onAddToCart, onWishlist, wishlist, onViewDetails }) => {
            return (
                <section className="container">
                    <h2 className="section-title">{title}</h2>
                    <div className="products">
                        {products.map(product => (
                            <ProductCard 
                                key={product.id} 
                                product={product} 
                                onProductClick={onProductClick}
                                onAddToCart={onAddToCart}
                                onWishlist={onWishlist}
                                isWishlisted={wishlist.some(item => item.id === product.id)}
                                onViewDetails={onViewDetails}
                            />
                        ))}
                    </div>
                </section>
            );
        };

        // Anime Section Component
        const AnimeSection = ({ anime, onProductClick, onAddToCart, onWishlist, wishlist, onViewDetails }) => {
            if (!anime) return null;

            return (
                <section className="container anime-section" id={`anime-${anime.title.toLowerCase().replace(/ /g, '-')}`}>
                    <div className="anime-header">
                        <h2 className="anime-title">{anime.title}</h2>
                        <a href="#" className="view-all">
                            View All <i className="fas fa-arrow-right"></i>
                        </a>
                    </div>
                    <p className="text-center mb-0" style={{ fontSize: '1.1rem', color: '#6c757d', marginBottom: '30px' }}>
                        {anime.description}
                    </p>
                    <div className="products">
                        {anime.products.map(product => (
                            <ProductCard 
                                key={product.id} 
                                product={product} 
                                onProductClick={onProductClick}
                                onAddToCart={onAddToCart}
                                onWishlist={onWishlist}
                                isWishlisted={wishlist.some(item => item.id === product.id)}
                                onViewDetails={onViewDetails}
                            />
                        ))}
                    </div>
                </section>
            );
        };

        // Footer Component
        const Footer = () => {
            return (
                <footer>
                    <div className="container">
                        <div className="footer-content">
                            <div className="footer-column">
                                <h3>AnimeCosplay India</h3>
                                <p>Your one-stop destination for premium anime cosplay costumes and accessories in India. We bring your favorite characters to life with authentic designs and quality materials.</p>
                                <div className="social-links">
                                    <a href="#"><i className="fab fa-facebook-f"></i></a>
                                    <a href="#"><i className="fab fa-twitter"></i></a>
                                    <a href="#"><i className="fab fa-instagram"></i></a>
                                    <a href="#"><i className="fab fa-youtube"></i></a>
                                    <a href="#"><i className="fab fa-pinterest"></i></a>
                                </div>
                            </div>
                            <div className="footer-column">
                                <h3>Shop</h3>
                                <ul className="footer-links">
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> One Piece Costumes</a></li>
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> Naruto Costumes</a></li>
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> Attack on Titan Costumes</a></li>
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> My Hero Academia Costumes</a></li>
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> Demon Slayer Costumes</a></li>
                                </ul>
                            </div>
                            <div className="footer-column">
                                <h3>Customer Service</h3>
                                <ul className="footer-links">
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> Contact Us</a></li>
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> Shipping Policy</a></li>
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> Returns & Exchanges</a></li>
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> Size Guide</a></li>
                                    <li><a href="#"><i className="fas fa-chevron-right"></i> FAQs</a></li>
                                </ul>
                            </div>
                            <div className="footer-column">
                                <h3>Contact Info</h3>
                                <ul className="footer-links">
                                    <li><a href="#"><i className="fas fa-map-marker-alt"></i> 123 Cosplay Street, Mumbai, India</a></li>
                                    <li><a href="#"><i className="fas fa-phone"></i> +91 98765 43210</a></li>
                                    <li><a href="#"><i className="fas fa-envelope"></i> support@animecosplayindia.com</a></li>
                                    <li><a href="#"><i className="fas fa-clock"></i> Mon-Sun: 10:00 AM - 8:00 PM</a></li>
                                </ul>
                                <div className="newsletter">
                                    <p>Subscribe to our newsletter for updates</p>
                                    <div className="newsletter-form">
                                        <input type="email" placeholder="Your email address" />
                                        <button><i className="fas fa-paper-plane"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div className="footer-bottom">
                            <p>&copy; 2023 AnimeCosplay India. All rights reserved. | Designed with <i className="fas fa-heart" style={{color: '#ff3e6c'}}></i> for anime fans</p>
                        </div>
                    </div>
                </footer>
            );
        };

        // Modal Component
        const Modal = ({ isOpen, onClose, children, size }) => {
            if (!isOpen) return null;

            return ReactDOM.createPortal(
                <div className="modal active" onClick={onClose}>
                    <div className={`modal-content ${size}`} onClick={(e) => e.stopPropagation()}>
                        <span className="close-modal" onClick={onClose}>&times;</span>
                        {children}
                    </div>
                </div>,
                document.body
            );
        };

        // Login Modal Component
        const LoginModal = ({ isOpen, onClose, onSwitchToSignup, onLoginSuccess }) => {
            const [formData, setFormData] = useState({
                email: '',
                password: ''
            });

            const handleChange = (e) => {
                setFormData({
                    ...formData,
                    [e.target.name]: e.target.value
                });
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                const result = AuthService.login(formData.email, formData.password);
                if (result.success) {
                    onLoginSuccess(result.user);
                    onClose();
                } else {
                    alert(result.message);
                }
            };

            return (
                <Modal isOpen={isOpen} onClose={onClose}>
                    <h2 className="modal-title">Login</h2>
                    <form id="login-form" onSubmit={handleSubmit}>
                        <div className="form-group">
                            <label htmlFor="login-email">Email</label>
                            <input 
                                type="email" 
                                id="login-email" 
                                name="email"
                                className="form-control" 
                                placeholder="Enter your email" 
                                value={formData.email}
                                onChange={handleChange}
                                required 
                            />
                        </div>
                        <div className="form-group">
                            <label htmlFor="login-password">Password</label>
                            <input 
                                type="password" 
                                id="login-password" 
                                name="password"
                                className="form-control" 
                                placeholder="Enter your password" 
                                value={formData.password}
                                onChange={handleChange}
                                required 
                            />
                        </div>
                        <button type="submit" className="submit-btn">Login</button>
                        <div className="form-footer">
                            <p>Don't have an account? <a href="#" onClick={(e) => { e.preventDefault(); onSwitchToSignup(); }}>Sign up</a></p>
                        </div>
                    </form>
                </Modal>
            );
        };

        // Signup Modal Component
        const SignupModal = ({ isOpen, onClose, onSwitchToLogin, onSignupSuccess }) => {
            const [formData, setFormData] = useState({
                name: '',
                email: '',
                password: '',
                confirmPassword: ''
            });

            const handleChange = (e) => {
                setFormData({
                    ...formData,
                    [e.target.name]: e.target.value
                });
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (formData.password !== formData.confirmPassword) {
                    alert('Passwords do not match');
                    return;
                }
                
                const result = AuthService.signup(formData);
                if (result.success) {
                    onSignupSuccess(result.user);
                    onClose();
                } else {
                    alert(result.message);
                }
            };

            return (
                <Modal isOpen={isOpen} onClose={onClose}>
                    <h2 className="modal-title">Sign Up</h2>
                    <form id="signup-form" onSubmit={handleSubmit}>
                        <div className="form-group">
                            <label htmlFor="signup-name">Full Name</label>
                            <input 
                                type="text" 
                                id="signup-name" 
                                name="name"
                                className="form-control" 
                                placeholder="Enter your full name" 
                                value={formData.name}
                                onChange={handleChange}
                                required 
                            />
                        </div>
                        <div className="form-group">
                            <label htmlFor="signup-email">Email</label>
                            <input 
                                type="email" 
                                id="signup-email" 
                                name="email"
                                className="form-control" 
                                placeholder="Enter your email" 
                                value={formData.email}
                                onChange={handleChange}
                                required 
                            />
                        </div>
                        <div className="form-group">
                            <label htmlFor="signup-password">Password</label>
                            <input 
                                type="password" 
                                id="signup-password" 
                                name="password"
                                className="form-control" 
                                placeholder="Create a password" 
                                value={formData.password}
                                onChange={handleChange}
                                required 
                            />
                        </div>
                        <div className="form-group">
                            <label htmlFor="signup-confirm">Confirm Password</label>
                            <input 
                                type="password" 
                                id="signup-confirm" 
                                name="confirmPassword"
                                className="form-control" 
                                placeholder="Confirm your password" 
                                value={formData.confirmPassword}
                                onChange={handleChange}
                                required 
                            />
                        </div>
                        <button type="submit" className="submit-btn">Sign Up</button>
                        <div className="form-footer">
                            <p>Already have an account? <a href="#" onClick={(e) => { e.preventDefault(); onSwitchToLogin(); }}>Login</a></p>
                        </div>
                    </form>
                </Modal>
            );
        };

        // Cart Modal Component
        const CartModal = ({ isOpen, onClose, cartItems, onUpdateQuantity, onRemoveItem, onCheckout }) => {
            const subtotal = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const shipping = subtotal > 0 ? 99 : 0;
            const tax = subtotal * 0.18;
            const total = subtotal + shipping + tax;

            return (
                <Modal isOpen={isOpen} onClose={onClose} size="cart-modal">
                    <div className="cart-header">
                        <h2 className="cart-title">Your Cart</h2>
                        <span>{cartItems.length} {cartItems.length === 1 ? 'item' : 'items'}</span>
                    </div>
                    <div className="cart-items">
                        {cartItems.length === 0 ? (
                            <div className="empty-cart">
                                <i className="fas fa-shopping-cart"></i>
                                <p>Your cart is empty</p>
                                <button className="cta-button" onClick={onClose}>Continue Shopping</button>
                            </div>
                        ) : (
                            cartItems.map(item => (
                                <div key={item.id} className="cart-item">
                                    <div className="cart-item-img" style={{ backgroundImage: `url(${item.image})` }}></div>
                                    <div className="cart-item-details">
                                        <div className="cart-item-title">{item.name}</div>
                                        {item.size && <div className="cart-item-size">Size: {item.size}</div>}
                                        <div className="cart-item-price">₹{item.price.toLocaleString()}</div>
                                        <div className="cart-item-actions">
                                            <div className="quantity-control">
                                                <button 
                                                    className="quantity-btn" 
                                                    onClick={() => onUpdateQuantity(item.id, item.quantity - 1)}
                                                    disabled={item.quantity <= 1}
                                                >-</button>
                                                <input 
                                                    type="text" 
                                                    className="quantity-input" 
                                                    value={item.quantity} 
                                                    readOnly
                                                />
                                                <button 
                                                    className="quantity-btn" 
                                                    onClick={() => onUpdateQuantity(item.id, item.quantity + 1)}
                                                >+</button>
                                            </div>
                                            <div className="remove-item" onClick={() => onRemoveItem(item.id)}>
                                                <i className="fas fa-trash"></i> Remove
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))
                        )}
                    </div>
                    {cartItems.length > 0 && (
                        <div className="cart-summary">
                            <div className="cart-totals">
                                <div className="cart-total-line">
                                    <span>Subtotal</span>
                                    <span>₹{subtotal.toLocaleString()}</span>
                                </div>
                                <div className="cart-total-line">
                                    <span>Shipping</span>
                                    <span>{shipping > 0 ? `₹${shipping}` : 'FREE'}</span>
                                </div>
                                <div className="cart-total-line">
                                    <span>Tax (18%)</span>
                                    <span>₹{tax.toFixed(0)}</span>
                                </div>
                                <div className="cart-total-line">
                                    <span>Total</span>
                                    <span>₹{total.toFixed(0)}</span>
                                </div>
                            </div>
                            <button className="checkout-btn" onClick={onCheckout}>
                                <i className="fas fa-lock"></i> Proceed to Checkout
                            </button>
                        </div>
                    )}
                </Modal>
            );
        };

        // Wishlist Modal Component
        const WishlistModal = ({ isOpen, onClose, wishlistItems, onRemoveItem, onAddToCart }) => {
            return (
                <Modal isOpen={isOpen} onClose={onClose} size="cart-modal">
                    <div className="cart-header">
                        <h2 className="cart-title">Your Wishlist</h2>
                        <span>{wishlistItems.length} {wishlistItems.length === 1 ? 'item' : 'items'}</span>
                    </div>
                    <div className="cart-items">
                        {wishlistItems.length === 0 ? (
                            <div className="empty-cart">
                                <i className="fas fa-heart"></i>
                                <p>Your wishlist is empty</p>
                                <button className="cta-button" onClick={onClose}>Continue Shopping</button>
                            </div>
                        ) : (
                            wishlistItems.map(item => (
                                <div key={item.id} className="cart-item">
                                    <div className="cart-item-img" style={{ backgroundImage: `url(${item.image})` }}></div>
                                    <div className="cart-item-details">
                                        <div className="cart-item-title">{item.name}</div>
                                        <div className="cart-item-price">₹{item.price.toLocaleString()}</div>
                                        <div className="cart-item-actions">
                                            <button 
                                                className="add-to-cart" 
                                                style={{ marginRight: '10px' }}
                                                onClick={() => onAddToCart(item)}
                                            >
                                                <i className="fas fa-shopping-cart"></i> Add to Cart
                                            </button>
                                            <div className="remove-item" onClick={() => onRemoveItem(item.id)}>
                                                <i className="fas fa-trash"></i> Remove
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))
                        )}
                    </div>
                </Modal>
            );
        };

        // Product Details Page Component
        const ProductDetailsPage = ({ product, onAddToCart, onBuyNow, onBack }) => {
            const [selectedSize, setSelectedSize] = useState('M');
            const [quantity, setQuantity] = useState(1);
            const [selectedImage, setSelectedImage] = useState(product.image);

            if (!product) return null;

            const renderStars = (rating) => {
                const stars = [];
                const fullStars = Math.floor(rating);
                const hasHalfStar = rating % 1 !== 0;

                for (let i = 0; i < fullStars; i++) {
                    stars.push(<i key={i} className="fas fa-star"></i>);
                }

                if (hasHalfStar) {
                    stars.push(<i key="half" className="fas fa-star-half-alt"></i>);
                }

                const emptyStars = 5 - stars.length;
                for (let i = 0; i < emptyStars; i++) {
                    stars.push(<i key={`empty-${i}`} className="far fa-star"></i>);
                }

                return stars;
            };

            const handleAddToCart = () => {
                onAddToCart(product, selectedSize, quantity);
            };

            const handleBuyNow = () => {
                onBuyNow(product, selectedSize, quantity);
            };

            // Generate additional product images for the gallery
            const productImages = [
                product.image,
                "https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80",
                "https://images.unsplash.com/photo-1632493563319-6c5be7025ecc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80",
                "https://images.unsplash.com/photo-1620641788421-7a1c342ea42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"
            ];

            return (
                <div className="product-details-page">
                    <div className="container">
                        <button className="view-all" onClick={onBack} style={{ marginBottom: '30px' }}>
                            <i className="fas fa-arrow-left"></i> Back to Products
                        </button>
                        <div className="product-details-container">
                            <div className="product-gallery">
                                <div 
                                    className="product-main-img"
                                    style={{ backgroundImage: `url(${selectedImage})` }}
                                ></div>
                                <div className="product-thumbnails">
                                    {productImages.map((image, index) => (
                                        <div 
                                            key={index}
                                            className={`product-thumbnail ${selectedImage === image ? 'active' : ''}`}
                                            style={{ backgroundImage: `url(${image})` }}
                                            onClick={() => setSelectedImage(image)}
                                        ></div>
                                    ))}
                                </div>
                            </div>
                            <div className="product-details-info">
                                <h1 className="product-details-title">{product.name}</h1>
                                <div className="product-details-price">₹{product.price.toLocaleString()}</div>
                                <div className="product-details-rating">
                                    {renderStars(product.rating)}
                                    <span>{product.rating} ({product.reviews} Reviews)</span>
                                </div>
                                <p className="product-details-description">
                                    {product.description}
                                </p>
                                
                                <div className="product-meta">
                                    <div className="meta-item">
                                        <i className="fas fa-box"></i>
                                        <span>Free Shipping</span>
                                    </div>
                                    <div className="meta-item">
                                        <i className="fas fa-undo"></i>
                                        <span>30 Day Returns</span>
                                    </div>
                                    <div className="meta-item">
                                        <i className="fas fa-shield-alt"></i>
                                        <span>1 Year Warranty</span>
                                    </div>
                                </div>

                                <div className="size-selector">
                                    <label>Select Size:</label>
                                    <div className="size-options">
                                        {product.sizes.map(size => (
                                            <div 
                                                key={size} 
                                                className={`size-option ${selectedSize === size ? 'active' : ''}`}
                                                onClick={() => setSelectedSize(size)}
                                            >
                                                {size}
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div style={{ marginBottom: '20px', display: 'flex', alignItems: 'center' }}>
                                    <label style={{ marginRight: '15px', fontWeight: '600' }}>Quantity:</label>
                                    <div className="quantity-control" style={{ display: 'flex', alignItems: 'center' }}>
                                        <button 
                                            className="quantity-btn" 
                                            onClick={() => setQuantity(Math.max(1, quantity - 1))}
                                        >-</button>
                                        <input 
                                            type="text" 
                                            className="quantity-input" 
                                            value={quantity} 
                                            readOnly
                                            style={{ width: '60px' }}
                                        />
                                        <button 
                                            className="quantity-btn" 
                                            onClick={() => setQuantity(quantity + 1)}
                                        >+</button>
                                    </div>
                                </div>

                                <div className="product-details-actions">
                                    <button 
                                        className="add-to-cart-large" 
                                        onClick={handleAddToCart}
                                    >
                                        <i className="fas fa-shopping-cart"></i> Add to Cart
                                    </button>
                                    <button className="buy-now" onClick={handleBuyNow}>
                                        <i className="fas fa-bolt"></i> Buy Now
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div className="reviews-section">
                            <div className="reviews-header">
                                <h3 className="reviews-title">Customer Reviews</h3>
                                <button className="view-all">Write a Review</button>
                            </div>
                            <div className="review-item">
                                <div className="review-header">
                                    <div className="review-author">Rahul Sharma</div>
                                    <div className="review-rating">
                                        <i className="fas fa-star"></i>
                                        <i className="fas fa-star"></i>
                                        <i className="fas fa-star"></i>
                                        <i className="fas fa-star"></i>
                                        <i className="fas fa-star"></i>
                                    </div>
                                </div>
                                <div className="review-date">Posted on October 12, 2023</div>
                                <p className="review-text">Amazing quality! The costume looks exactly like in the anime. Got so many compliments at the convention. Definitely worth the price!</p>
                            </div>
                            <div className="review-item">
                                <div className="review-header">
                                    <div className="review-author">Priya Patel</div>
                                    <div className="review-rating">
                                        <i className="fas fa-star"></i>
                                        <i className="fas fa-star"></i>
                                        <i className="fas fa-star"></i>
                                        <i className="fas fa-star"></i>
                                        <i className="far fa-star"></i>
                                    </div>
                                </div>
                                <div className="review-date">Posted on September 28, 2023</div>
                                <p className="review-text">The material is good quality and comfortable to wear. The sizing was accurate. The straw hat is a bit flimsy but overall a great product.</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Checkout Page Component
        const CheckoutPage = ({ cartItems, onPlaceOrder, onBack }) => {
            const [formData, setFormData] = useState({
                firstName: '',
                lastName: '',
                email: '',
                phone: '',
                address: '',
                city: '',
                state: '',
                pincode: '',
                paymentMethod: 'card'
            });

            const subtotal = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const shipping = subtotal > 0 ? 99 : 0;
            const tax = subtotal * 0.18;
            const total = subtotal + shipping + tax;

            const handleChange = (e) => {
                setFormData({
                    ...formData,
                    [e.target.name]: e.target.value
                });
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onPlaceOrder({
                    ...formData,
                    items: cartItems,
                    total: total
                });
            };

            return (
                <div className="checkout-page">
                    <div className="container">
                        <button className="view-all" onClick={onBack} style={{ marginBottom: '30px' }}>
                            <i className="fas fa-arrow-left"></i> Back to Cart
                        </button>
                        <h1 className="section-title">Checkout</h1>
                        <div className="checkout-container">
                            <div className="checkout-form">
                                <form onSubmit={handleSubmit}>
                                    <div className="form-section">
                                        <h3 className="form-section-title">Shipping Information</h3>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label htmlFor="firstName">First Name</label>
                                                <input 
                                                    type="text" 
                                                    id="firstName" 
                                                    name="firstName"
                                                    className="form-control" 
                                                    value={formData.firstName}
                                                    onChange={handleChange}
                                                    required 
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label htmlFor="lastName">Last Name</label>
                                                <input 
                                                    type="text" 
                                                    id="lastName" 
                                                    name="lastName"
                                                    className="form-control" 
                                                    value={formData.lastName}
                                                    onChange={handleChange}
                                                    required 
                                                />
                                            </div>
                                        </div>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label htmlFor="email">Email</label>
                                                <input 
                                                    type="email" 
                                                    id="email" 
                                                    name="email"
                                                    className="form-control" 
                                                    value={formData.email}
                                                    onChange={handleChange}
                                                    required 
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label htmlFor="phone">Phone</label>
                                                <input 
                                                    type="tel" 
                                                    id="phone" 
                                                    name="phone"
                                                    className="form-control" 
                                                    value={formData.phone}
                                                    onChange={handleChange}
                                                    required 
                                                />
                                            </div>
                                        </div>
                                        <div className="form-group">
                                            <label htmlFor="address">Address</label>
                                            <input 
                                                type="text" 
                                                id="address" 
                                                name="address"
                                                className="form-control" 
                                                value={formData.address}
                                                onChange={handleChange}
                                                required 
                                            />
                                        </div>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label htmlFor="city">City</label>
                                                <input 
                                                    type="text" 
                                                    id="city" 
                                                    name="city"
                                                    className="form-control" 
                                                    value={formData.city}
                                                    onChange={handleChange}
                                                    required 
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label htmlFor="state">State</label>
                                                <input 
                                                    type="text" 
                                                    id="state" 
                                                    name="state"
                                                    className="form-control" 
                                                    value={formData.state}
                                                    onChange={handleChange}
                                                    required 
                                                />
                                            </div>
                                        </div>
                                        <div className="form-group">
                                            <label htmlFor="pincode">PIN Code</label>
                                            <input 
                                                type="text" 
                                                id="pincode" 
                                                name="pincode"
                                                className="form-control" 
                                                value={formData.pincode}
                                                onChange={handleChange}
                                                required 
                                            />
                                        </div>
                                    </div>

                                    <div className="form-section">
                                        <h3 className="form-section-title">Payment Method</h3>
                                        <div className="payment-methods">
                                            <div 
                                                className={`payment-method ${formData.paymentMethod === 'card' ? 'active' : ''}`}
                                                onClick={() => setFormData({...formData, paymentMethod: 'card'})}
                                            >
                                                <div className="payment-icon">
                                                    <i className="far fa-credit-card"></i>
                                                </div>
                                                <div>
                                                    <div style={{ fontWeight: '600' }}>Credit/Debit Card</div>
                                                    <div style={{ fontSize: '0.9rem', color: 'var(--gray)' }}>Pay securely with your card</div>
                                                </div>
                                            </div>
                                            <div 
                                                className={`payment-method ${formData.paymentMethod === 'upi' ? 'active' : ''}`}
                                                onClick={() => setFormData({...formData, paymentMethod: 'upi'})}
                                            >
                                                <div className="payment-icon">
                                                    <i className="fas fa-mobile-alt"></i>
                                                </div>
                                                <div>
                                                    <div style={{ fontWeight: '600' }}>UPI</div>
                                                    <div style={{ fontSize: '0.9rem', color: 'var(--gray)' }}>Pay using UPI apps</div>
                                                </div>
                                            </div>
                                            <div 
                                                className={`payment-method ${formData.paymentMethod === 'cod' ? 'active' : ''}`}
                                                onClick={() => setFormData({...formData, paymentMethod: 'cod'})}
                                            >
                                                <div className="payment-icon">
                                                    <i className="fas fa-money-bill-wave"></i>
                                                </div>
                                                <div>
                                                    <div style={{ fontWeight: '600' }}>Cash on Delivery</div>
                                                    <div style={{ fontSize: '0.9rem', color: 'var(--gray)' }}>Pay when you receive the order</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <button type="submit" className="place-order-btn">
                                        Place Order
                                    </button>
                                </form>
                            </div>
                            <div className="checkout-summary">
                                <h3 style={{ marginBottom: '20px', color: 'var(--secondary)' }}>Order Summary</h3>
                                {cartItems.map(item => (
                                    <div key={item.id} className="summary-item">
                                        <div>
                                            <div style={{ fontWeight: '600' }}>{item.name}</div>
                                            <div style={{ fontSize: '0.9rem', color: 'var(--gray)' }}>Qty: {item.quantity}</div>
                                        </div>
                                        <div>₹{(item.price * item.quantity).toLocaleString()}</div>
                                    </div>
                                ))}
                                <div className="summary-item">
                                    <div>Subtotal</div>
                                    <div>₹{subtotal.toLocaleString()}</div>
                                </div>
                                <div className="summary-item">
                                    <div>Shipping</div>
                                    <div>{shipping > 0 ? `₹${shipping}` : 'FREE'}</div>
                                </div>
                                <div className="summary-item">
                                    <div>Tax</div>
                                    <div>₹{tax.toFixed(0)}</div>
                                </div>
                                <div className="summary-total">
                                    <div>Total</div>
                                    <div>₹{total.toFixed(0)}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Order Success Page Component
        const OrderSuccessPage = ({ order, onContinueShopping, onViewOrders }) => {
            return (
                <div className="success-page">
                    <div className="container">
                        <div className="success-icon">
                            <i className="fas fa-check-circle"></i>
                        </div>
                        <h1 className="success-title">Order Placed Successfully!</h1>
                        <p className="success-message">
                            Thank you for your order! Your order has been confirmed and will be shipped within 3-5 business days. 
                            You will receive a confirmation email shortly with your order details.
                        </p>
                        <div className="success-actions">
                            <button className="cta-button" onClick={onContinueShopping}>
                                Continue Shopping
                            </button>
                            <button className="view-details" onClick={onViewOrders}>
                                View My Orders
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // Account Page Component
        const AccountPage = ({ currentUser, onUpdateProfile, onBack, onViewOrders }) => {
            const [activeTab, setActiveTab] = useState('profile');
            const [profileData, setProfileData] = useState({
                name: currentUser?.name || '',
                email: currentUser?.email || '',
                phone: currentUser?.phone || '',
                address: currentUser?.address || ''
            });

            const handleProfileChange = (e) => {
                setProfileData({
                    ...profileData,
                    [e.target.name]: e.target.value
                });
            };

            const handleProfileSubmit = (e) => {
                e.preventDefault();
                const result = AuthService.updateProfile(currentUser.id, profileData);
                if (result.success) {
                    onUpdateProfile(result.user);
                    alert('Profile updated successfully!');
                } else {
                    alert(result.message);
                }
            };

            return (
                <div className="account-page">
                    <div className="container">
                        <button className="view-all" onClick={onBack} style={{ marginBottom: '30px' }}>
                            <i className="fas fa-arrow-left"></i> Back to Store
                        </button>
                        <h1 className="section-title">My Account</h1>
                        <div className="account-container">
                            <div className="account-sidebar">
                                <ul className="account-menu">
                                    <li>
                                        <a 
                                            href="#" 
                                            className={activeTab === 'profile' ? 'active' : ''}
                                            onClick={(e) => { e.preventDefault(); setActiveTab('profile'); }}
                                        >
                                            <i className="fas fa-user"></i> Profile
                                        </a>
                                    </li>
                                    <li>
                                        <a 
                                            href="#" 
                                            className={activeTab === 'orders' ? 'active' : ''}
                                            onClick={(e) => { e.preventDefault(); setActiveTab('orders'); }}
                                        >
                                            <i className="fas fa-shopping-bag"></i> Orders
                                        </a>
                                    </li>
                                    <li>
                                        <a 
                                            href="#" 
                                            className={activeTab === 'addresses' ? 'active' : ''}
                                            onClick={(e) => { e.preventDefault(); setActiveTab('addresses'); }}
                                        >
                                            <i className="fas fa-map-marker-alt"></i> Addresses
                                        </a>
                                    </li>
                                    <li>
                                        <a 
                                            href="#" 
                                            className={activeTab === 'wishlist' ? 'active' : ''}
                                            onClick={(e) => { e.preventDefault(); setActiveTab('wishlist'); }}
                                        >
                                            <i className="fas fa-heart"></i> Wishlist
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div className="account-content">
                                {activeTab === 'profile' && (
                                    <div className="account-section">
                                        <h2 className="account-section-title">Profile Information</h2>
                                        <div className="profile-avatar">
                                            {currentUser?.name?.charAt(0).toUpperCase()}
                                        </div>
                                        <form onSubmit={handleProfileSubmit}>
                                            <div className="profile-info">
                                                <div className="form-group">
                                                    <label htmlFor="account-name">Full Name</label>
                                                    <input 
                                                        type="text" 
                                                        id="account-name" 
                                                        name="name"
                                                        className="form-control" 
                                                        value={profileData.name}
                                                        onChange={handleProfileChange}
                                                        required 
                                                    />
                                                </div>
                                                <div className="form-group">
                                                    <label htmlFor="account-email">Email</label>
                                                    <input 
                                                        type="email" 
                                                        id="account-email" 
                                                        name="email"
                                                        className="form-control" 
                                                        value={profileData.email}
                                                        onChange={handleProfileChange}
                                                        required 
                                                    />
                                                </div>
                                                <div className="form-group">
                                                    <label htmlFor="account-phone">Phone</label>
                                                    <input 
                                                        type="tel" 
                                                        id="account-phone" 
                                                        name="phone"
                                                        className="form-control" 
                                                        value={profileData.phone}
                                                        onChange={handleProfileChange}
                                                    />
                                                </div>
                                                <div className="form-group">
                                                    <label htmlFor="account-address">Address</label>
                                                    <input 
                                                        type="text" 
                                                        id="account-address" 
                                                        name="address"
                                                        className="form-control" 
                                                        value={profileData.address}
                                                        onChange={handleProfileChange}
                                                    />
                                                </div>
                                            </div>
                                            <button type="submit" className="save-btn">Save Changes</button>
                                        </form>
                                    </div>
                                )}
                                {activeTab === 'orders' && (
                                    <div className="account-section">
                                        <h2 className="account-section-title">Order History</h2>
                                        {currentUser?.orders && currentUser.orders.length > 0 ? (
                                            <div className="order-history">
                                                {currentUser.orders.map(order => (
                                                    <div key={order.id} className="order-card">
                                                        <div className="order-header">
                                                            <div>
                                                                <div className="order-id">Order #{order.id}</div>
                                                                <div className="order-date">
                                                                    {new Date(order.date).toLocaleDateString('en-IN', { 
                                                                        day: 'numeric', 
                                                                        month: 'long', 
                                                                        year: 'numeric' 
                                                                    })}
                                                                </div>
                                                            </div>
                                                            <div className={`order-status status-${order.status}`}>
                                                                {order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                                                            </div>
                                                        </div>
                                                        <div className="order-items">
                                                            {order.items.map(item => (
                                                                <div key={item.id} className="order-item">
                                                                    <div 
                                                                        className="order-item-img"
                                                                        style={{ backgroundImage: `url(${item.image})` }}
                                                                    ></div>
                                                                    <div className="order-item-name">{item.name}</div>
                                                                    <div className="order-item-price">₹{item.price.toLocaleString()}</div>
                                                                </div>
                                                            ))}
                                                        </div>
                                                        <div className="order-total">
                                                            <div>Total</div>
                                                            <div>₹{order.total.toFixed(0)}</div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        ) : (
                                            <div className="empty-cart">
                                                <i className="fas fa-shopping-bag"></i>
                                                <p>You haven't placed any orders yet</p>
                                                <button className="cta-button" onClick={onBack}>Start Shopping</button>
                                            </div>
                                        )}
                                    </div>
                                )}
                                {activeTab === 'addresses' && (
                                    <div className="account-section">
                                        <h2 className="account-section-title">Saved Addresses</h2>
                                        <p>Manage your shipping addresses here.</p>
                                        {/* Address management would be implemented here */}
                                    </div>
                                )}
                                {activeTab === 'wishlist' && (
                                    <div className="account-section">
                                        <h2 className="account-section-title">My Wishlist</h2>
                                        <p>View and manage your wishlist items.</p>
                                        {/* Wishlist management would be implemented here */}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            const [currentPage, setCurrentPage] = useState('home');
            const [activeModal, setActiveModal] = useState(null);
            const [selectedProduct, setSelectedProduct] = useState(null);
            const [activeCategory, setActiveCategory] = useState('');
            const [cartItems, setCartItems] = useState([]);
            const [wishlist, setWishlist] = useState([]);
            const [toast, setToast] = useState({ show: false, message: '', type: '' });
            const [currentUser, setCurrentUser] = useState(AuthService.currentUser);
            const [currentOrder, setCurrentOrder] = useState(null);

            const showToast = (message, type = '') => {
                setToast({ show: true, message, type });
            };

            const hideToast = () => {
                setToast({ ...toast, show: false });
            };

            const handleLoginClick = () => {
                setActiveModal('login');
            };

            const handleCartClick = () => {
                setActiveModal('cart');
            };

            const handleWishlistClick = () => {
                setActiveModal('wishlist');
            };

            const handleProductClick = (product) => {
                setSelectedProduct(product);
                setActiveModal('product-details');
            };

            const handleViewDetails = (product) => {
                setSelectedProduct(product);
                setCurrentPage('product-details');
            };

            const handleCategoryClick = (category) => {
                setActiveCategory(category);
                // Scroll to the anime section
                setTimeout(() => {
                    const element = document.getElementById(`anime-${category}`);
                    if (element) {
                        element.scrollIntoView({ behavior: 'smooth' });
                    }
                }, 100);
            };

            const handleCategoryChange = (category) => {
                setActiveCategory(category);
                // Scroll to the anime section
                setTimeout(() => {
                    const element = document.getElementById(`anime-${category}`);
                    if (element) {
                        element.scrollIntoView({ behavior: 'smooth' });
                    }
                }, 100);
            };

            const handleAddToCart = (product, size = 'M', quantity = 1) => {
                const existingItem = cartItems.find(item => item.id === product.id && item.size === size);
                
                if (existingItem) {
                    setCartItems(cartItems.map(item => 
                        item.id === product.id && item.size === size
                            ? { ...item, quantity: item.quantity + quantity } 
                            : item
                    ));
                } else {
                    setCartItems([...cartItems, { ...product, quantity, size }]);
                }
                
                showToast(`${product.name} added to cart!`, 'success');
            };

            const handleUpdateQuantity = (productId, newQuantity) => {
                if (newQuantity < 1) return;
                
                setCartItems(cartItems.map(item => 
                    item.id === productId 
                        ? { ...item, quantity: newQuantity } 
                        : item
                ));
            };

            const handleRemoveItem = (productId) => {
                setCartItems(cartItems.filter(item => item.id !== productId));
                showToast('Item removed from cart', 'warning');
            };

            const handleCheckout = () => {
                if (!currentUser) {
                    setActiveModal('login');
                    showToast('Please login to proceed with checkout', 'warning');
                    return;
                }
                setCurrentPage('checkout');
                setActiveModal(null);
            };

            const handlePlaceOrder = (orderData) => {
                const result = AuthService.addOrder(currentUser.id, orderData);
                if (result.success) {
                    setCurrentOrder(result.order);
                    setCartItems([]); // Clear cart after successful order
                    setCurrentPage('order-success');
                    setCurrentUser(AuthService.currentUser); // Update current user with new order
                } else {
                    alert('Failed to place order: ' + result.message);
                }
            };

            const handleWishlist = (product, isWishlisted) => {
                if (isWishlisted) {
                    setWishlist([...wishlist, product]);
                    showToast(`${product.name} added to wishlist!`, 'success');
                } else {
                    setWishlist(wishlist.filter(item => item.id !== product.id));
                    showToast(`${product.name} removed from wishlist`, 'warning');
                }
            };

            const handleRemoveWishlistItem = (productId) => {
                setWishlist(wishlist.filter(item => item.id !== productId));
                showToast('Item removed from wishlist', 'warning');
            };

            const handleBuyNow = (product, size = 'M', quantity = 1) => {
                handleAddToCart(product, size, quantity);
                if (!currentUser) {
                    setActiveModal('login');
                    showToast('Please login to proceed with checkout', 'warning');
                    return;
                }
                setCurrentPage('checkout');
            };

            const handleLoginSuccess = (user) => {
                setCurrentUser(user);
                showToast(`Welcome back, ${user.name}!`, 'success');
            };

            const handleSignupSuccess = (user) => {
                setCurrentUser(user);
                showToast(`Account created successfully! Welcome, ${user.name}!`, 'success');
            };

            const handleLogout = () => {
                AuthService.logout();
                setCurrentUser(null);
                showToast('You have been logged out', 'info');
            };

            const handleAccountClick = () => {
                setCurrentPage('account');
            };

            const handleBackToHome = () => {
                setCurrentPage('home');
                setSelectedProduct(null);
                setCurrentOrder(null);
            };

            const handleContinueShopping = () => {
                setCurrentPage('home');
                setCurrentOrder(null);
            };

            const handleViewOrders = () => {
                setCurrentPage('account');
                setCurrentOrder(null);
            };

            const handleUpdateProfile = (user) => {
                setCurrentUser(user);
            };

            const cartCount = cartItems.reduce((total, item) => total + item.quantity, 0);
            const wishlistCount = wishlist.length;

            // Get featured products (products with featured: true)
            const featuredProducts = Object.values(productDatabase)
                .flatMap(anime => anime.products)
                .filter(product => product.featured)
                .slice(0, 8);

            return (
                <div>
                    {currentPage === 'home' && (
                        <>
                            <Header 
                                onLoginClick={handleLoginClick} 
                                onCartClick={handleCartClick}
                                onWishlistClick={handleWishlistClick}
                                cartCount={cartCount}
                                wishlistCount={wishlistCount}
                                activeCategory={activeCategory}
                                onCategoryChange={handleCategoryChange}
                                currentUser={currentUser}
                                onLogout={handleLogout}
                                onAccountClick={handleAccountClick}
                            />
                            <Hero />
                            <Categories onCategoryClick={handleCategoryClick} />
                            
                            {!activeCategory && (
                                <ProductsSection 
                                    title="Featured Costumes"
                                    products={featuredProducts}
                                    onProductClick={handleProductClick}
                                    onAddToCart={handleAddToCart}
                                    onWishlist={handleWishlist}
                                    wishlist={wishlist}
                                    onViewDetails={handleViewDetails}
                                />
                            )}
                            
                            {activeCategory && productDatabase[activeCategory] && (
                                <div id={`anime-${activeCategory}`}>
                                    <AnimeSection 
                                        anime={productDatabase[activeCategory]}
                                        onProductClick={handleProductClick}
                                        onAddToCart={handleAddToCart}
                                        onWishlist={handleWishlist}
                                        wishlist={wishlist}
                                        onViewDetails={handleViewDetails}
                                    />
                                </div>
                            )}
                            
                            {!activeCategory && Object.entries(productDatabase).map(([key, anime]) => (
                                <AnimeSection 
                                    key={key}
                                    anime={anime}
                                    onProductClick={handleProductClick}
                                    onAddToCart={handleAddToCart}
                                    onWishlist={handleWishlist}
                                    wishlist={wishlist}
                                    onViewDetails={handleViewDetails}
                                />
                            ))}
                            
                            <Footer />
                        </>
                    )}

                    {currentPage === 'product-details' && selectedProduct && (
                        <>
                            <Header 
                                onLoginClick={handleLoginClick} 
                                onCartClick={handleCartClick}
                                onWishlistClick={handleWishlistClick}
                                cartCount={cartCount}
                                wishlistCount={wishlistCount}
                                activeCategory={activeCategory}
                                onCategoryChange={handleCategoryChange}
                                currentUser={currentUser}
                                onLogout={handleLogout}
                                onAccountClick={handleAccountClick}
                            />
                            <ProductDetailsPage 
                                product={selectedProduct}
                                onAddToCart={handleAddToCart}
                                onBuyNow={handleBuyNow}
                                onBack={handleBackToHome}
                            />
                            <Footer />
                        </>
                    )}

                    {currentPage === 'checkout' && (
                        <>
                            <Header 
                                onLoginClick={handleLoginClick} 
                                onCartClick={handleCartClick}
                                onWishlistClick={handleWishlistClick}
                                cartCount={cartCount}
                                wishlistCount={wishlistCount}
                                activeCategory={activeCategory}
                                onCategoryChange={handleCategoryChange}
                                currentUser={currentUser}
                                onLogout={handleLogout}
                                onAccountClick={handleAccountClick}
                            />
                            <CheckoutPage 
                                cartItems={cartItems}
                                onPlaceOrder={handlePlaceOrder}
                                onBack={() => setCurrentPage('home')}
                            />
                        </>
                    )}

                    {currentPage === 'order-success' && currentOrder && (
                        <>
                            <Header 
                                onLoginClick={handleLoginClick} 
                                onCartClick={handleCartClick}
                                onWishlistClick={handleWishlistClick}
                                cartCount={cartCount}
                                wishlistCount={wishlistCount}
                                activeCategory={activeCategory}
                                onCategoryChange={handleCategoryChange}
                                currentUser={currentUser}
                                onLogout={handleLogout}
                                onAccountClick={handleAccountClick}
                            />
                            <OrderSuccessPage 
                                order={currentOrder}
                                onContinueShopping={handleContinueShopping}
                                onViewOrders={handleViewOrders}
                            />
                            <Footer />
                        </>
                    )}

                    {currentPage === 'account' && currentUser && (
                        <>
                            <Header 
                                onLoginClick={handleLoginClick} 
                                onCartClick={handleCartClick}
                                onWishlistClick={handleWishlistClick}
                                cartCount={cartCount}
                                wishlistCount={wishlistCount}
                                activeCategory={activeCategory}
                                onCategoryChange={handleCategoryChange}
                                currentUser={currentUser}
                                onLogout={handleLogout}
                                onAccountClick={handleAccountClick}
                            />
                            <AccountPage 
                                currentUser={currentUser}
                                onUpdateProfile={handleUpdateProfile}
                                onBack={handleBackToHome}
                                onViewOrders={handleViewOrders}
                            />
                            <Footer />
                        </>
                    )}

                    <LoginModal 
                        isOpen={activeModal === 'login'} 
                        onClose={() => setActiveModal(null)}
                        onSwitchToSignup={() => setActiveModal('signup')}
                        onLoginSuccess={handleLoginSuccess}
                    />
                    <SignupModal 
                        isOpen={activeModal === 'signup'} 
                        onClose={() => setActiveModal(null)}
                        onSwitchToLogin={() => setActiveModal('login')}
                        onSignupSuccess={handleSignupSuccess}
                    />
                    <CartModal 
                        isOpen={activeModal === 'cart'} 
                        onClose={() => setActiveModal(null)}
                        cartItems={cartItems}
                        onUpdateQuantity={handleUpdateQuantity}
                        onRemoveItem={handleRemoveItem}
                        onCheckout={handleCheckout}
                    />
                    <WishlistModal 
                        isOpen={activeModal === 'wishlist'} 
                        onClose={() => setActiveModal(null)}
                        wishlistItems={wishlist}
                        onRemoveItem={handleRemoveWishlistItem}
                        onAddToCart={handleAddToCart}
                    />

                    <Toast 
                        message={toast.message}
                        type={toast.type}
                        show={toast.show}
                        onClose={hideToast}
                    />
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>